# Cookie とセッションについて説明できる

## 1. ステートレス

HTTP は特徴としてステートレスであると言われます。ステートレスとは何か、プログラミング初心者にわかるように説明してください。

- 直訳すると、状態を持たない。つまり1回目のリクエストと次に送る2回目のリクエストは関連性がなく、それぞれ独立した通信になる。
- メリットとしては、サーバーで過去のリクエストに関する情報を保持する必要がないため、リソースを節約でき、大量のリクエストを効率的に処理するのに役立つ。
- デメリットとしては、例えばECサイトなどのユーザー情報を保持し続ける必要があるウェブアプリケーションにおいてステートレスは課題である。

## 2. Cookie とセッション

HTTP がステートレスであることを考えると、ログイン状態を保持することができません。しかし現実のアプリケーションではログイン状態を保持できないと大変不便です。

そこでログイン状態を保持するために Cookie とセッションが使われます。以下について説明してください。

- Cookie とセッションとはそれぞれ何か？
- **Cookie**
  - ユーザーのブラウザに保存する小さなテキストファイル
  - サーバーからブラウザに送信される情報で、ブラウザはそれを保存し、次回のリクエスト時にクッキーと一緒に送信する。

- **Session**
  - 一連の処理の始まりから終わりまでを表す概念
  - ユーザーセッション情報はサーバー側で管理され、セッションIDを通じて識別される。

- Cookie とセッションの違いは？
  - 保存場所：クッキーはクライアント側、セッションはサーバー側で保存される。ただし、ユーザーのセッションIDはクッキーを用いてクライアント側で保存される。
  - データ量：クッキーに保存できるデータ量は通常、４KB程である。一方、セッションはサーバー側で保存されるため、クッキーに比べると大量のデータを保存することができる。
  - セキュリティ：クッキーはクライアント側に保存されるため、ユーザーによって編集されたり、悪意のある第三者によって盗まれる可能性がある。一方、セッションはサーバー側に保存され、セッションIDを通じてアクセスできるので、クッキーにユーザー情報を保存するよりクッキーにセッションIDを保存するほうがセキュリティは高い。

- Cookie とセッションを利用してどのようにログイン状態を実現しているのか？
  1. ログイン：ユーザーがユーザー名とパスワードを入力し、ログインする。
  2. 認証：サーバーは送られてきたユーザー名とパスワードを確認し、ユーザー認証を行い、成功したら新しいセッションを作成する。
  3. セッション作成：新しく作成したセッションには、一意のセッションIDを割り当て、セッションにはユーザーがログイン中である状態やユーザーの各種設定などの情報が保存される。
  4. クッキー設定：サーバーはレスポンスの一部としてセッションIDをクッキーに保存する。セッションIDはHTTPレスポンスの「Set-Cookie」ヘッダーを通じてブラウザに送信される。
  5. ログイン状態の維持：ユーザーが新たにページをリクエストすると、ブラウザはセッションIDを含むクッキーをリクエストヘッダーに含めてサーバーに送る。サーバーはセッションIDを取得し、対応するセッション見つけ、レスポンスを返す。
  6. ログアウト：ユーザーがログアウトすると、サーバーは該当のセッションを破棄し、セッションIDが無効となる。

## 3. Cookie の確認

ブラウザで Cookie を確認してみましょう。

`www.google.com` にログインした状態でアクセスし、Cookie を確認してください。
